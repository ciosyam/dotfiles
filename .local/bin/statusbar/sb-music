#!/bin/sh

# Function to filter MPC status
filter_mpc() {
    # Extract the song title and include the pause emoji if paused
    awk '
    /^[a-zA-Z]/ { split($0, a, " - "); song_title=a[2] }
    /^\[playing\]/ { print song_title }
    /^[volume|repeat|random|single|consume]/ { exit }
    ' | head -n 1
}

# Get current song and status from MPC
current_song=$(mpc status | filter_mpc)

# Output the combined information with the emoji
echo "$current_song"

# Notify the status bar immediately
pkill -USR1 "${STATUSBAR:-dwmblocks}"
